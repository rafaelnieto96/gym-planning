{"ast":null,"code":"import _asyncToGenerator from \"/Users/rafa/Sites/Proyectos/gym-planning/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { __decorate } from \"tslib\";\nimport { Component, Output, EventEmitter, Input, ViewChild, HostListener } from '@angular/core';\nimport html2canvas from 'html2canvas';\nexport let WeeklyCalendarComponent = class WeeklyCalendarComponent {\n  constructor(renderer, elementRef) {\n    this.renderer = renderer;\n    this.elementRef = elementRef;\n    this.selectedExercise = null;\n    this.days = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'];\n    this.exercises = [];\n    this.squareClicked = new EventEmitter();\n    this.exerciseClicked = new EventEmitter();\n  }\n  onScroll(event) {\n    const element = event.target;\n    if (element && element.classList) {\n      if (element.classList.contains('day-content')) {\n        this.dayTitle.nativeElement.scrollLeft = element.scrollLeft;\n      } else if (element.classList.contains('day-title')) {\n        this.dayContent.nativeElement.scrollLeft = element.scrollLeft;\n      }\n    }\n  }\n  handleSquareClick(event, day) {\n    if (event.target.classList.contains('square') || event.target.classList.contains('plus-btn')) {\n      this.openPopupOnClick(day);\n    }\n  }\n  openPopupOnClick(day) {\n    this.squareClicked.emit(day);\n  }\n  openEditExercisePopup(exercise) {\n    this.exerciseClicked.emit(exercise);\n  }\n  deleteAllExercises() {\n    this.exerciseService.deleteAllExercises().subscribe(() => {\n      console.log('All exercises deleted successfully.');\n    }, error => {\n      console.error('Error deleting exercises:', error);\n    }, () => {\n      window.location.reload();\n    });\n  }\n  toggleExerciseButtons(exercise) {\n    exercise.showButtons = !exercise.showButtons;\n    this.exercises.forEach(ex => {\n      if (ex !== exercise) {\n        ex.showButtons = false;\n      }\n    });\n  }\n  deleteExercise(id) {\n    this.exerciseService.deleteExercise(id).subscribe(() => {\n      console.log('Exercise deleted');\n    }, err => {\n      console.error('Error deleting exercise:', err);\n    }, () => {\n      window.location.reload();\n    });\n  }\n  downloadCalendar() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      const dayContent = _this.elementRef.nativeElement.querySelector('.day-content');\n      if (!dayContent) return;\n      const cloneContent = dayContent.cloneNode(true);\n      const fullContentView = _this.renderer.createElement('div');\n      _this.renderer.setStyle(fullContentView, 'overflow', 'visible');\n      _this.renderer.appendChild(fullContentView, cloneContent);\n      const canvas = yield html2canvas(fullContentView, {\n        allowTaint: true,\n        useCORS: true,\n        scrollY: -window.scrollY // Consider the current scroll position\n      });\n\n      const link = document.createElement('a');\n      link.download = 'full-calendar-view.png';\n      link.href = canvas.toDataURL();\n      link.click();\n    })();\n  }\n};\n__decorate([ViewChild('calendar', {\n  static: false\n})], WeeklyCalendarComponent.prototype, \"calendarElement\", void 0);\n__decorate([Input()], WeeklyCalendarComponent.prototype, \"exercises\", void 0);\n__decorate([Output()], WeeklyCalendarComponent.prototype, \"squareClicked\", void 0);\n__decorate([Output()], WeeklyCalendarComponent.prototype, \"exerciseClicked\", void 0);\n__decorate([ViewChild('dayTitle')], WeeklyCalendarComponent.prototype, \"dayTitle\", void 0);\n__decorate([ViewChild('dayContent')], WeeklyCalendarComponent.prototype, \"dayContent\", void 0);\n__decorate([HostListener('scroll', ['$event'])], WeeklyCalendarComponent.prototype, \"onScroll\", null);\nWeeklyCalendarComponent = __decorate([Component({\n  selector: 'app-weekly-calendar',\n  templateUrl: './weekly-calendar.component.html',\n  styleUrls: ['./weekly-calendar.component.css']\n})], WeeklyCalendarComponent);","map":{"version":3,"names":["Component","Output","EventEmitter","Input","ViewChild","HostListener","html2canvas","WeeklyCalendarComponent","constructor","renderer","elementRef","selectedExercise","days","exercises","squareClicked","exerciseClicked","onScroll","event","element","target","classList","contains","dayTitle","nativeElement","scrollLeft","dayContent","handleSquareClick","day","openPopupOnClick","emit","openEditExercisePopup","exercise","deleteAllExercises","exerciseService","subscribe","console","log","error","window","location","reload","toggleExerciseButtons","showButtons","forEach","ex","deleteExercise","id","err","downloadCalendar","_this","_asyncToGenerator","querySelector","cloneContent","cloneNode","fullContentView","createElement","setStyle","appendChild","canvas","allowTaint","useCORS","scrollY","link","document","download","href","toDataURL","click","__decorate","static","selector","templateUrl","styleUrls"],"sources":["/Users/rafa/Sites/Proyectos/gym-planning/src/app/weekly-calendar/weekly-calendar.component.ts"],"sourcesContent":["import { Component, Output, EventEmitter, Input, ViewChild, HostListener, ElementRef } from '@angular/core';\nimport { ExerciseService } from '../exercise.service';\nimport html2canvas from 'html2canvas';\n@Component({\n    selector: 'app-weekly-calendar',\n    templateUrl: './weekly-calendar.component.html',\n    styleUrls: ['./weekly-calendar.component.css'],\n})\nexport class WeeklyCalendarComponent {\n    @ViewChild('calendar', { static: false }) calendarElement!: ElementRef<HTMLDivElement>;\n\n    constructor(private renderer: Renderer2, private elementRef: ElementRef) {}\n    selectedExercise: any = null;\n\n    days: string[] = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'];\n\n    @Input() exercises: any[] = [];\n\n    @Output() squareClicked: EventEmitter<any> = new EventEmitter();\n    @Output() exerciseClicked: EventEmitter<any> = new EventEmitter();\n\n    @ViewChild('dayTitle') dayTitle!: ElementRef;\n    @ViewChild('dayContent') dayContent!: ElementRef;\n\n    @HostListener('scroll', ['$event'])\n    onScroll(event: Event): void {\n        const element = event.target as HTMLElement;\n        if (element && element.classList) {\n            if (element.classList.contains('day-content')) {\n                this.dayTitle.nativeElement.scrollLeft = element.scrollLeft;\n            } else if (element.classList.contains('day-title')) {\n                this.dayContent.nativeElement.scrollLeft = element.scrollLeft;\n            }\n        }\n    }\n\n    handleSquareClick(event: MouseEvent, day: string) {\n        if ((event.target as HTMLElement).classList.contains('square') || (event.target as HTMLElement).classList.contains('plus-btn')) {\n            this.openPopupOnClick(day);\n        }\n    }\n\n    openPopupOnClick(day: string): void {\n        this.squareClicked.emit(day);\n    }\n\n    openEditExercisePopup(exercise: any): void {\n        this.exerciseClicked.emit(exercise);\n    }\n\n    deleteAllExercises(): void {\n        this.exerciseService.deleteAllExercises().subscribe(\n            () => {\n                console.log('All exercises deleted successfully.');\n            },\n            (error) => {\n                console.error('Error deleting exercises:', error);\n            },\n            () => {\n                window.location.reload();\n            }\n        );\n    }\n\n    toggleExerciseButtons(exercise: any) {\n        exercise.showButtons = !exercise.showButtons;\n\n        this.exercises.forEach((ex: any) => {\n            if (ex !== exercise) {\n                ex.showButtons = false;\n            }\n        });\n    }\n\n    deleteExercise(id: any): void {\n        this.exerciseService.deleteExercise(id).subscribe(\n            () => {\n                console.log('Exercise deleted');\n            },\n            (err) => {\n                console.error('Error deleting exercise:', err);\n            },\n            () => {\n                window.location.reload();\n            }\n        );\n    }\n\n\n    async downloadCalendar() {\n        const dayContent = this.elementRef.nativeElement.querySelector('.day-content') as HTMLElement;\n        if (!dayContent) return;\n    \n        const cloneContent = dayContent.cloneNode(true) as HTMLElement;\n        const fullContentView = this.renderer.createElement('div');\n        this.renderer.setStyle(fullContentView, 'overflow', 'visible');\n        this.renderer.appendChild(fullContentView, cloneContent);\n    \n        const canvas = await html2canvas(fullContentView, {\n          allowTaint: true,\n          useCORS: true,\n          scrollY: -window.scrollY // Consider the current scroll position\n        });\n    \n        const link = document.createElement('a');\n        link.download = 'full-calendar-view.png';\n        link.href = canvas.toDataURL();\n        link.click();\n      }\n    \n    \n\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}